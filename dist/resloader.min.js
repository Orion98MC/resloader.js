!function(a){"use strict";var b=function(a){var b=function(a,b){return this._events||(this._events={}),this._events[a]=this._events[a]||[],this._events[a].push(b),this},c=function(a){if(this._events||(this._events={}),this._events[a]){var b=Array.prototype.slice.apply(arguments);b.shift();for(var c=0;c<this._events[a].length;c++){var d=this._events[a][c];d.apply(this,b)}}return this},d=function(a,b){this._events||(this._events={});var c=this._events[a].indexOf(b);return this._events[a].splice(c,1),this};return"function"==typeof a?(a.prototype.on=b,a.prototype.emit=c,a.prototype.off=d,!0):"object"==typeof a?(a.on=b,a.emit=c,a.off=d,!0):!1},c=function(a,b){return a.currentStyle?a.currentStyle[b]:window.getComputedStyle?document.defaultView.getComputedStyle(a,null).getPropertyValue(b):a.style[b]},d=function(a){return"none"===c(a,"display")?!1:a.parentNode===document?!0:d(a.parentNode)},e=function(a,b){a=a||document;for(var e,f=a.getElementsByTagName("*"),g={},h=0;h<f.length;h++){var i,j=f[h];i="IMG"===j.tagName.toUpperCase()?"url("+j.src+")":c(j,"background-image"),i&&(!b||d(j))&&"none"!==i&&i.match(/^url/)&&(e=i.match(/^url\("?([^"]*)"?\)/)[1],g[e]||(g[e]=[]),g[e].push(j))}return g};Date.now||(Date.now=function(){return(new Date).getTime()}),Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;d>g;g++)a.call(e,c[g])&&h.push(c[g]);return h}}());var f=function(a,b,c){for(var d=document.cookie.split(/;\s+/),e=0;e<d.length;e++){var f=d[e].split("=");if(f&&f[0]===a)return c(!1)}var g=new Date(Date.now()+1e3*(b||3600)),f=a+"=true; expires="+g.toUTCString();document.cookie=f,c(!0)},g={finished:0,left:0,length:0,results:{},progress:0},h=function(a,b){if(a=a instanceof Array?a:[a],!a||!a.length)return b(g),void 0;for(var c=a.length,d=Date.now(),e={},f=0;f<a.length;f++){var h=new Image,i=function(){c--,e[this.src]=this.naturalWidth>0,b({left:c,length:a.length,progress:(a.length-c)/a.length}),0===c&&b({finished:Date.now()-d,left:c,length:a.length,results:e,progress:1})};h.onload=i,h.onerror=i,h.src=a[f]}},i=function(a,b){for(var c in b)a.style[c]=b[c]},j=function(a,b,c,d){var e=document.createElement(b||"div");return e.id=c,d&&i(e,d),a.appendChild(e),e},k=function(a,b){if("object"!=typeof this)return new this(a,b);var c={verbose:!1,beforeDelay:0,afterDelay:1e3,resources:[],expires:null,loadInvisible:!1,onbefore:function(a){a()},autostart:!0};for(var d in a)c[d]=a[d];if(this.config=c,this.callback=b,this.resources=Array.prototype.concat.apply(c.resources,Object.keys(e(document,!c.loadInvisible))),this.started=!1,c.autostart){var f=this;setTimeout(function(){f.start()},0)}return this};if(!b(k))throw new Error("Cannot Eventify object");k.prototype.start=function(){var a=this.config,b=this.resources,c=this.callback,d=this;if(this.started)return console.log("already started"),void 0;if(this.started=!0,this.emit("start"),!this.resources.length)return console.log("no resources to load"),c&&c(g),this;var e=function(b){d.emit("finish"),a.afterDelay<0||!a.overlayDiv||a.overlayDiv.parentNode.removeChild(a.overlayDiv),c&&c(b)},i=function(){a.onbefore(function(){h(b,function(b){d.emit("progress",b),b.finished&&setTimeout(function(){e(b)},a.afterDelay)})})};return a.expires?(f("resloader",a.expires,function(b){return d.emit("cookie",b),b?(setTimeout(i,a.beforeDelay),void 0):(e(),void 0)}),void 0):(setTimeout(i,a.beforeDelay),void 0)},k.UI=function(a,b){var c={root:document.body,type:"bar"};for(var d in a)c[d]=a[d];var e=new k(c,b),f=e.config.onbefore;return e.config.onbefore=function(a){e.setupUI.call(e),f?f.call(e,a):a()},e},k.prototype.setupUI=function(){var a=this,b=this.config;switch(b.overlayDiv=j(b.root,"div","resloader_overlay",{position:"fixed",top:0,left:0,bottom:0,right:0,width:"100%",heigth:"100%",zIndex:9999999}),b.overlayDiv.className=b.type,b.headerDiv=j(b.overlayDiv,"div","resloader_header"),b.progressDiv=j(b.overlayDiv,"div","resloader_progress",{position:"relative"}),b.indicatorDiv=j(b.progressDiv,"div","resloader_indicator",{overflow:"hidden"}),b.labelDiv=j(b.progressDiv,"div","resloader_label"),b.footerDiv=j(b.overlayDiv,"div","resloader_footer"),b.type){case"bar":i(b.indicatorDiv,{position:"relative"});var c=j(b.indicatorDiv,"div","resloader_bar",{position:"absolute",top:0,left:0,width:"0%",height:"100%"});a.on("progress",function(a){var d=Math.ceil(100*a.progress)+"%";c.style.width=d,b.labelDiv.textContent=d}),a.emit("progress",{progress:0})}a.emit("setupUI")},a.Resloader=k,a.Resloader.exports={getStyle:c,isVisibleElement:d,loadableImageURLs:e,appendElement:j,Eventify:b}}(window);